(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{D9Tt:function(t,e,n){"use strict";n.d(e,"a",(function(){return K}));var r=n("rePB"),o=n("HaE+"),a=n("q1tI"),i=n.n(a),c=n("ODXe"),u=n("UzkQ"),l=function(t){var e=Object(u.useRefState)(0),n=Object(c.a)(e,3),r=n[0],o=n[1],i=n[2],l=Object(a.useRef)(null),s=function(){l.current&&clearInterval(l.current)};return Object(a.useEffect)((function(){return"ANSWERED"===t?(s(),i(0),l.current=setInterval((function(){i(o.current+1)}),1e3)):"ENDED"===t&&s(),s}),[t]),r},s=n("mwIZ"),f=n.n(s),h=n("J/PD"),d=n.n(h),p=function(t){if(t)return t.replace("+","")};function m(){m=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function s(t,e,n,r){var a=e&&e.prototype instanceof y?e:y,i=Object.create(a.prototype),c=new D(r||[]);return o(i,"_invoke",{value:S(t,n,c)}),i}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var h="suspendedStart",d="suspendedYield",p="executing",v="completed",g={};function y(){}function b(){}function w(){}var E={};l(E,i,(function(){return this}));var N=Object.getPrototypeOf,O=N&&N(N(T([])));O&&O!==n&&r.call(O,i)&&(E=O);var x=w.prototype=y.prototype=Object.create(E);function C(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function n(o,a,i,c){var u=f(t[o],t,a);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"==typeof s&&r.call(s,"__await")?e.resolve(s.__await).then((function(t){n("next",t,i,c)}),(function(t){n("throw",t,i,c)})):e.resolve(s).then((function(t){l.value=t,i(l)}),(function(t){return n("throw",t,i,c)}))}c(u.arg)}var a;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return a=a?a.then(o,o):o()}})}function S(e,n,r){var o=h;return function(a,i){if(o===p)throw Error("Generator is already running");if(o===v){if("throw"===a)throw i;return{value:t,done:!0}}for(r.method=a,r.arg=i;;){var c=r.delegate;if(c){var u=L(c,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===h)throw o=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=p;var l=f(e,n,r);if("normal"===l.type){if(o=r.done?v:d,l.arg===g)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=v,r.method="throw",r.arg=l.arg)}}}function L(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,L(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var a=f(o,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,g;var i=a.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function D(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function T(e){if(e||""===e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(typeof e+" is not iterable")}return b.prototype=w,o(x,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:b,configurable:!0}),b.displayName=l(w,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,l(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},C(j.prototype),l(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,n,r,o,a){void 0===a&&(a=Promise);var i=new j(s(t,n,r,o),a);return e.isGeneratorFunction(n)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},C(x),l(x,u,"Generator"),l(x,i,(function(){return this})),l(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=T,D.prototype={constructor:D,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(u&&l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;I(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:T(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}var v=function(t){return t.CONNECTING="CONNECTING",t.CONNECTED="CONNECTED",t.DISCONNECTED="DISCONNECTED",t}({}),g=function(t){return t[t.INIT=0]="INIT",t[t.CALLING=1]="CALLING",t[t.RINGING=2]="RINGING",t[t.ANSWERED=3]="ANSWERED",t[t.CONNECTED=4]="CONNECTED",t[t.BUSY=5]="BUSY",t[t.ENDED=6]="ENDED",t}({}),y=Object.values(g),b=function(t){return d()(g)[t]},w=function(t){var e=t.getCallAccessToken,n=Object(u.useRefState)(void 0),r=Object(c.a)(n,3),i=r[1],l=r[2],s=Object(a.useState)(v.DISCONNECTED),h=s[0],d=s[1],w=Object(a.useState)(void 0),E=w[0],N=w[1],O=Object(a.useState)(!1),x=O[0],C=O[1],j=Object(a.useState)({}),S=j[0],L=j[1],k=function(){var t=Object(o.a)(m().mark((function t(){var n;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e();case 2:n=t.sent,N(n);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();Object(a.useEffect)((function(){k()}),[]),Object(a.useEffect)((function(){E&&S.StringeeClient&&S.StringeeCall&&function(t){var e=new S.StringeeClient;e.on("connect",(function(){console.log("client connect"),d(v.CONNECTED)})),e.on("disconnect",(function(){console.log("client disconnect"),d(v.DISCONNECTED)})),e.on("authen",(function(t){})),e.on("requestnewtoken",Object(o.a)(m().mark((function t(){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",k());case 1:case"end":return t.stop()}}),t)})))),e.on("otherdeviceauthen",(function(t){})),e.connect(t),d(v.CONNECTING),l(e)}(E)}),[E,S]),Object(a.useLayoutEffect)((function(){var t=f()(window,"StringeeClient"),e=f()(window,"StringeeCall");L({StringeeCall:e,StringeeClient:t})}),[]);return{makeCall:function(t){var e=t.localVideo,n=t.remoteVideo,r=t.fromNumber,o=t.toPhoneNumber,a=t.custom,c=t.onCallStateChange,u=t.onMediaStateChange;if(!i||!i.current||h!==v.CONNECTED||!S.StringeeCall)throw new Error("Call is not ready");var l=new S.StringeeCall(i.current,p(r),p(o),!1);l.custom=a,l.on("addremotestream",(function(t){console.log("addremotestream hook running"),n&&(n.srcObject=null,n.srcObject=t)})),l.on("addlocalstream",(function(t){console.log("addlocalstream hook running"),e&&(e.srcObject=null,e.muted=!0,e.srcObject=t)})),l.on("signalingstate",(function(t){var e,n=t||{},r=n.code,o=n.sipCode,a=n.reason;if(console.log("signalingstate hook running with state: ",t),"number"===typeof(e=r)&&y.includes(e)){var i=b(r);c&&c(i,o,a)}})),l.on("mediastate",(function(t){var e=t.code;console.log("mediastate hook running with state: ",t),"number"===typeof e&&u&&u(e)})),l.on("info",(function(t){})),l.makeCall((function(t){console.log("make call hook running with res: ",t)}));return{hangup:function(){e.srcObject=null,n.srcObject=null,l.hangup((function(t){0===t.r&&c&&c(b(g.ENDED))}))},muteCall:function(){var t=!l.muted;l.mute(t),C(t)}}},status:h,reconnect:function(){i.current.connect(E)},callMuted:x}},E=n("LeJ0"),N=n("ORBA"),O=n("y7GW"),x=n("LvDl"),C=n.n(x),j=n("Nhdc"),S=i.a.createElement,L=function(t){var e=t.localVideoRef,n=t.remoteVideoRef;return S("div",null,S("video",{autoPlay:!0,style:{width:"0px",height:"0px",visibility:"hidden"},ref:e}),S("video",{autoPlay:!0,style:{width:"0px",height:"0px",visibility:"hidden"},ref:n}))},k=n("QMWJ"),I=n.n(k),D=n("e45s"),T=n.n(D),_=T()((function(){return{contactBar:{display:"flex",gap:"2px"},expandIcon:{display:"flex",cursor:"pointer",width:36,height:36,justifyContent:"center",alignItems:"center"},active:{backgroundColor:"#1890FF",color:"#fff"},contactOption:{display:"flex",alignItems:"center",gap:"18px",padding:"4px 8px",borderRadius:"2px",cursor:"pointer",backgroundColor:"#F5F5F5",minHeight:36,minWidth:280,justifyContent:"space-around","&:hover":{backgroundColor:"#1890FF",color:"#fff",opacity:.8},"&.active":{backgroundColor:"#1890FF",color:"#fff"}},smallIcon:{fontSize:16}}})),P=i.a.createElement,G=function(t){var e=_(),n=t.student,r=t.onSelect,o=t.t,c=Object(a.useState)(!1),u=c[0],l=c[1],s=Object(a.useState)(),f=s[0],h=s[1],d=function(){l((function(t){return!t}))},p=[{phoneNumber:C.a.get(n,"customer.phoneNumber")||"",name:o("callCustomerLabel"),type:"customer"},{phoneNumber:C.a.get(n,"phoneNumber")||"",name:o("callStudentLabel"),type:"student"},{phoneNumber:C.a.get(n,"contactPhoneNumber")||"",name:o("contactPhoneNumber"),type:"student"}],m=C.a.uniqBy(p,"phoneNumber").filter((function(t){return Boolean(t.phoneNumber)}));return Object(a.useEffect)((function(){h({phoneNumber:C.a.get(n,"customer.phoneNumber")||"",name:o("callCustomerLabel"),type:"customer"})}),[n]),m&&m.length?P("div",{className:e.contactBar},P("div",null,u?P(i.a.Fragment,null,m.map((function(t,e){return P(R,{key:e,phoneNumber:t.phoneNumber,name:t.name,isSelected:t.phoneNumber===C.a.get(f,"phoneNumber"),onSelect:function(){h(t),r(t),d()}})}))):P(R,{phoneNumber:C.a.get(f,"phoneNumber")||"",name:C.a.get(f,"name")||"",isSelected:!0,onSelect:function(){f&&r(f)}})),m.length>1?P("div",null,P("span",{className:"".concat(e.expandIcon," ").concat(e.active),onClick:d},P(j.gb,{name:"ExpandMore",color:"inherit"}))):null):P(j.jc,null,"No contact")},R=function(t){var e=_(),n=t.phoneNumber,r=t.name,o=t.isSelected,a=t.onSelect;return P("div",{className:"".concat(e.contactOption," ").concat(o?"active":""),onClick:a},P(I.a,{color:"inherit",className:e.smallIcon}),P("span",null,r),P("span",null,n))},B=i.a.createElement,F=function(t){var e=t.onClose,n=t.open,r=t.t,o=[{content:r("common:iUnderstand"),style:{backgroundColor:u.blue[800],color:"#fff",minHeight:28,height:28,marginTop:8},onClick:function(){e()}}];return B(j.c,{open:n,handleClose:e,title:r("Note"),content:B("div",null,r("warningMicrophonePermissionMsg")),dialogActions:o})},M=n("RYcK"),z=n.n(M),V=n("JA/3"),A=n.n(V),Y=T()((function(){return{closeCallBtn:{color:"#fff",width:24,height:24,background:"red","&:hover":{backgroundColor:"#ff8f8f"}},muteCallBtn:{color:"#fff",background:"#38BDF8",width:24,height:24,"&:hover":{backgroundColor:"#38bdf88a"}},textSmall:{fontSize:"10px"},labelText:{fontSize:"14px",lineHeight:"20px"},studentCallBarInfo:{display:"flex",justifyContent:"space-between",gap:"24px",height:49,minWidth:350,padding:8,boxShadow:"0 1px 2px 1px rgba(0,0,0,0.2)"},studentCallBarControl:{display:"flex",gap:"8px",alignItems:"start"},smallIcon:{fontSize:14},skeleton:{position:"relative"},closeSkeletonButton:{position:"absolute",top:4,right:4}}})),H=i.a.createElement,J=function(t){var e=Y(),n=t.status,r=t.hangUp,o=t.toggleMic,a=t.callTarget,c=t.callState,u=t.isMutedCall,s=C.a.get(a,"phoneNumber",""),f=C.a.get(a,"name"),h=n===v.CONNECTED,d=l(c);if(!h)return H("div",{className:e.skeleton},H(j.Pb,{variant:"rect",height:49,width:250}),H(j.hb,{onClick:r,size:"small",className:e.closeSkeletonButton},H(j.gb,{name:"Close",color:"inherit",className:e.smallIcon})));var p,m=function(t){var e=!!t&&!["ANSWERED","ENDED"].includes(t);return{durationVisible:!!t&&["ANSWERED","ENDED"].includes(t),stateVisible:e,hangUpVisible:!!t&&!["BUSY","ENDED"].includes(t),callAgainVisible:!!t&&["ENDED","BUSY"].includes(t)}}(c),g=m.durationVisible,y=m.stateVisible;return H(i.a.Fragment,null,H("div",{className:e.studentCallBarInfo},h&&H(i.a.Fragment,null,H("div",null,H(j.jc,{className:e.labelText},f),H(j.jc,{className:e.textSmall},s)),H("div",null,g&&H(j.jc,null,(p=d)?new Date(1e3*p).toISOString().substring(11,19):""),y&&H(j.jc,null,function(t){var e="BUSY"===t?"BUSY":"CALLING";return C.a.capitalize(e)}(c),"..."))),H("div",{className:e.studentCallBarControl},H(j.hb,{onClick:r,size:"small",className:e.closeCallBtn},H(j.gb,{name:"Close",color:"inherit",className:e.smallIcon})),H(j.hb,{onClick:o,size:"small",className:e.muteCallBtn},u?H(A.a,{color:"inherit",width:16,className:e.smallIcon}):H(z.a,{color:"inherit",className:e.smallIcon})))))},U=T()((function(){return{root:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingTop:4},blockCall:{display:"flex",gap:"2px"},closeCallBtn:{color:"#fff",width:24,height:24,background:"red","&:hover":{backgroundColor:"#ff8f8f"}},muteCallBtn:{color:"#fff",background:"#38BDF8",width:24,height:24,"&:hover":{backgroundColor:"#38bdf88a"}},textSmall:{fontSize:"10px"},labelText:{fontSize:"14px",lineHeight:"20px"},studentCallBarInfo:{display:"flex",justifyContent:"space-between",gap:"24px",height:49,minWidth:350,padding:8,boxShadow:"0 1px 2px 1px rgba(0,0,0,0.2)"},studentCallBarControl:{display:"flex",gap:"8px",alignItems:"start"},smallIcon:{fontSize:14},hidden:{width:0,height:0,opacity:0},closeSkeletonButton:{position:"absolute",top:10,right:10}}})),q=i.a.createElement;function W(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Q(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?W(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Z(){Z=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function s(t,e,n,r){var a=e&&e.prototype instanceof g?e:g,i=Object.create(a.prototype),c=new I(r||[]);return o(i,"_invoke",{value:j(t,n,c)}),i}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var h="suspendedStart",d="suspendedYield",p="executing",m="completed",v={};function g(){}function y(){}function b(){}var w={};l(w,i,(function(){return this}));var E=Object.getPrototypeOf,N=E&&E(E(D([])));N&&N!==n&&r.call(N,i)&&(w=N);var O=b.prototype=g.prototype=Object.create(w);function x(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function n(o,a,i,c){var u=f(t[o],t,a);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"==typeof s&&r.call(s,"__await")?e.resolve(s.__await).then((function(t){n("next",t,i,c)}),(function(t){n("throw",t,i,c)})):e.resolve(s).then((function(t){l.value=t,i(l)}),(function(t){return n("throw",t,i,c)}))}c(u.arg)}var a;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return a=a?a.then(o,o):o()}})}function j(e,n,r){var o=h;return function(a,i){if(o===p)throw Error("Generator is already running");if(o===m){if("throw"===a)throw i;return{value:t,done:!0}}for(r.method=a,r.arg=i;;){var c=r.delegate;if(c){var u=S(c,r);if(u){if(u===v)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===h)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=p;var l=f(e,n,r);if("normal"===l.type){if(o=r.done?m:d,l.arg===v)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=m,r.method="throw",r.arg=l.arg)}}}function S(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,S(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var a=f(o,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,v;var i=a.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function D(e){if(e||""===e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(typeof e+" is not iterable")}return y.prototype=b,o(O,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:y,configurable:!0}),y.displayName=l(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,l(t,u,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},x(C.prototype),l(C.prototype,c,(function(){return this})),e.AsyncIterator=C,e.async=function(t,n,r,o,a){void 0===a&&(a=Promise);var i=new C(s(t,n,r,o),a);return e.isGeneratorFunction(n)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},x(O),l(O,u,"Generator"),l(O,i,(function(){return this})),l(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=D,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(u&&l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;k(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:D(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}var K=function(t){var e,n=U(),r=t.student,i=t.t,c=t.caller,l=t.onEndedCall,s=Object(a.useRef)(null),f=Object(a.useRef)(null),h=(E.a.calls||{}).stringee,d=Object(a.useState)(void 0),p=d[0],m=d[1],v=Object(a.useState)(!1),g=v[0],y=v[1],b=Object(a.useState)(!1),x=b[0],S=b[1],k=Object(a.useState)(void 0),I=k[0],D=k[1],T=Object(a.useState)(void 0),_=T[0],P=T[1],R=Object(a.useState)(h.fromNumbers[0]||h.defaultFromNumber),B=R[0],M=R[1],z=w({getCallAccessToken:O.b}),V=z.makeCall,A=z.status,Y=z.callMuted,H=function(){var t=Object(o.a)(Z().mark((function t(){var e,n;return Z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=sessionStorage.getItem("microphone_warning"),t.next=3,Object(N.j)();case 3:if(n=t.sent,e||n){t.next=7;break}return y(!0),t.abrupt("return",!1);case 7:return t.abrupt("return",!0);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),W=function(t,e,n){D(t),"ENDED"===t&&403===e&&Object(u.showNotification)({type:"ERROR",message:i("dncErrorMessage")})},K=function(t){try{var e=(E.a.calls||{}).customInfo,n=void 0===e?{}:e,o=t.type,a=t.phoneNumber,i={fromNumber:B.number,toPhoneNumber:a,localVideo:s.current,remoteVideo:f.current,custom:Q(Q({},n),{},{associatedId:null===r||void 0===r?void 0:r.id,customerId:C.a.get(r,"customer._id"),callerId:null===c||void 0===c?void 0:c.id,callerName:null===c||void 0===c?void 0:c.name,callerRoleId:null===c||void 0===c?void 0:c.roleId,type:o}),onCallStateChange:W};console.log({callPayload:i});var l=V(i);P(l)}catch(h){Object(u.showNotification)({type:"ERROR",message:C.a.get(h,"message")})}},X=function(){var t=Object(o.a)(Z().mark((function t(e){var n;return Z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,H();case 2:n=t.sent,m(e),K(e),n&&S(!0);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),$={status:A,callState:I,hangUp:function(){D("ENDED"),S(!1),_&&(_.hangup(),l&&l())},toggleMic:function(){if(_)try{_.muteCall()}catch(t){console.log("mute call failed: ",t)}},callTarget:p,isMutedCall:Y},tt=function(){_&&_.hangup()};return Object(a.useEffect)((function(){return window.addEventListener("beforeunload",tt),function(){window.removeEventListener("beforeunload",tt)}}),[_]),r?q("div",{className:n.root},x&&q(J,$),q("div",{className:"".concat(n.blockCall," ").concat(x?n.hidden:"")},q(j.N,{type:"picker",pickerDataSources:((null===h||void 0===h?void 0:null===(e=h.fromNumbers)||void 0===e?void 0:e.length)?h.fromNumbers:[]).map((function(t){return{value:t.number,label:t.name}})),value:B.number,onValueChange:function(t){M(h.fromNumbers.find((function(e){return e.number===t}))||h.defaultFromNumber)}}),q(G,{t:i,student:r,onSelect:X})),q(F,{t:i,open:g,onClose:function(){sessionStorage.setItem("microphone_warning","true"),y(!1)}}),q(L,{localVideoRef:s,remoteVideoRef:f})):q("div",null)}},"I+LG":function(t,e,n){var r=n("JC6p");t.exports=function(t,e,n,o){return r(t,(function(t,r,a){e(o,n(t),r,a)})),o}},"J/PD":function(t,e,n){var r=n("cvCv"),o=n("Q62E"),a=n("zZ0H"),i=Object.prototype.toString,c=o((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=i.call(e)),t[e]=n}),r(a));t.exports=c},"JA/3":function(t,e,n){"use strict";var r=n("TqRt");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=r(n("q1tI")),a=(0,r(n("8/g6")).default)(o.default.createElement(o.default.Fragment,null,o.default.createElement("path",{fill:"none",d:"M0 0h24v24H0zm0 0h24v24H0z"}),o.default.createElement("path",{d:"M19 11h-1.7c0 .74-.16 1.43-.43 2.05l1.23 1.23c.56-.98.9-2.09.9-3.28zm-4.02.17c0-.06.02-.11.02-.17V5c0-1.66-1.34-3-3-3S9 3.34 9 5v.18l5.98 5.99zM4.27 3L3 4.27l6.01 6.01V11c0 1.66 1.33 3 2.99 3 .22 0 .44-.03.65-.08l1.66 1.66c-.71.33-1.5.52-2.31.52-2.76 0-5.3-2.1-5.3-5.1H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c.91-.13 1.77-.45 2.54-.9L19.73 21 21 19.73 4.27 3z"})),"MicOff");e.default=a},Jaxp:function(t,e,n){"use strict";var r=n("2LY3");n.d(e,"a",(function(){return r.c})),n.d(e,"b",(function(){return r.d})),n.d(e,"c",(function(){return r.g})),n.d(e,"d",(function(){return r.h})),n.d(e,"e",(function(){return r.k})),n.d(e,"f",(function(){return r.m})),n.d(e,"g",(function(){return r.o})),n.d(e,"h",(function(){return r.p})),n.d(e,"i",(function(){return r.q})),n.d(e,"j",(function(){return r.s})),n.d(e,"k",(function(){return r.t})),n.d(e,"l",(function(){return r.u})),n.d(e,"m",(function(){return r.w})),n.d(e,"n",(function(){return r.F})),n.d(e,"o",(function(){return r.G})),n.d(e,"p",(function(){return r.H})),n.d(e,"q",(function(){return r.J})),n.d(e,"r",(function(){return r.U})),n.d(e,"s",(function(){return r.Y})),n.d(e,"t",(function(){return r.Z})),n.d(e,"u",(function(){return r.gb})),n.d(e,"v",(function(){return r.kb}))},Q62E:function(t,e,n){var r=n("I+LG");t.exports=function(t,e){return function(n,o){return r(n,t,e(o),{})}}},QMWJ:function(t,e,n){"use strict";var r=n("TqRt");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=r(n("q1tI")),a=(0,r(n("8/g6")).default)(o.default.createElement("path",{d:"M17.46 5c-.06.89-.21 1.76-.45 2.59l1.2 1.2c.41-1.2.67-2.47.76-3.79h-1.51zM7.6 17.02c-.85.24-1.72.39-2.6.45v1.49c1.32-.09 2.59-.35 3.8-.75l-1.2-1.19zM16.5 3H20c.55 0 1 .45 1 1 0 9.39-7.61 17-17 17-.55 0-1-.45-1-1v-3.49c0-.55.45-1 1-1 1.24 0 2.45-.2 3.57-.57.1-.04.21-.05.31-.05.26 0 .51.1.71.29l2.2 2.2c2.83-1.45 5.15-3.76 6.59-6.59l-2.2-2.2c-.28-.28-.36-.67-.25-1.02.37-1.12.57-2.32.57-3.57 0-.55.45-1 1-1z"}),"PhoneEnabledOutlined");e.default=a},RYcK:function(t,e,n){"use strict";var r=n("TqRt");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=r(n("q1tI")),a=(0,r(n("8/g6")).default)(o.default.createElement("path",{d:"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm-1.2-9.1c0-.66.54-1.2 1.2-1.2.66 0 1.2.54 1.2 1.2l-.01 6.2c0 .66-.53 1.2-1.19 1.2-.66 0-1.2-.54-1.2-1.2V4.9zm6.5 6.1c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z"}),"MicNone");e.default=a}}]);